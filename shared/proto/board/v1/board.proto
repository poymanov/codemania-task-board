syntax = "proto3";

package board.v1;

import "validate/validate.proto";

option go_package = "github.com/poymanov/codemania-task-board/pkg/proto/board/v1;board_v1";

service BoardService {
  rpc Create(BoardServiceCreateRequest) returns (BoardServiceCreateResponse);
  rpc GetAll(BoardServiceGetAllRequest) returns (BoardServiceGetAllResponse);
  rpc Delete(BoardServiceDeleteRequest) returns (BoardServiceDeleteResponse);
}

service ColumnService {
  rpc Create(ColumnServiceCreateRequest) returns (ColumnServiceCreateResponse);
  rpc GetAll(ColumnServiceGetAllRequest) returns (ColumnServiceGetAllResponse);
  rpc Delete(ColumnServiceDeleteRequest) returns (ColumnServiceDeleteResponse);
}

// Запрос на создание доски
message BoardServiceCreateRequest {
  // Название доски
  string name = 1 [(validate.rules).string = {min_len: 1}];

  // Описание доски
  string description = 2 [(validate.rules).string = {min_len: 1}];

  // ID владельца доски
  int64 owner_id = 3 [(validate.rules).int64.gte = 1];
}

// Запрос на получение всех досок по ID владельца
message BoardServiceGetAllRequest {
  BoardGetAllFilter filter = 1;
}

// Запрос на удаление доски
message BoardServiceDeleteRequest {
  // ID доски
  int64 id = 1  [(validate.rules).int64.gte = 1];
}

// Запрос на создание колонки
message ColumnServiceCreateRequest {
  // Название колонки
  string name = 1 [(validate.rules).string = {min_len: 1}];

  // ID доски
  int64 board_id = 2 [(validate.rules).int64.gte = 1];
}

// Запрос на получение списка колонок
message ColumnServiceGetAllRequest {
  ColumnGetAllFilter filter = 1;

  ColumnGetAllSort sort = 2;
}

// Запрос на удаление колонки
message ColumnServiceDeleteRequest {
  // ID доски
  int64 id = 1  [(validate.rules).int64.gte = 1];
}

// Ответ со списком всех досок
message BoardServiceGetAllResponse {
  // Список досок
  repeated Board boards = 1;
}

// Ответ на создание доски
message BoardServiceCreateResponse {
  int64 board_id = 3;
}

// Ответ на удаление доски
message BoardServiceDeleteResponse {

}

// Ответ на создание колонки
message ColumnServiceCreateResponse {
  int64 column_id = 1;
}

// Ответ на получение списка колонок
message ColumnServiceGetAllResponse {
  repeated Column columns = 1;
}

// Ответ на удаление колонки
message ColumnServiceDeleteResponse {

}

// Доска
message Board {
  // ID доски
  int64 id = 1;

  // Название доски
  string name = 2;

  // Описание доски
  string description = 3;

  // ID владельца доски
  int64 owner_id = 4;
}

// Колонка
message Column {
  // ID колонки
  int64 id = 1;

  // Название колонки
  string name = 2;

  // Порядок расположения доски
  float position = 3;

  // ID доски, к которой принадлежит колонка
  int64 board_id = 4;
}


// Фильтр для запроса по всем доскам
message BoardGetAllFilter {
  // ID владельца доски
  optional int64 owner_id = 1 [(validate.rules).int64.gte = 1];
}

// Фильтр для запроса по всем колонкам
message ColumnGetAllFilter {
  // ID доски
  optional int64 board_id = 1 [(validate.rules).int64.gte = 1];
}

// Опции сортировки для запроса по всем колонкам
message ColumnGetAllSort {
  // ID доски
  optional string position = 1 [(validate.rules).string = {min_len: 1}];
}
